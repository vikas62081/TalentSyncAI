import torch
from transformers import WhisperProcessor, WhisperForConditionalGeneration
import torchaudio

class WhisperAudioTranscriber:
    def __init__(self, model_name="openai/whisper-tiny", chunk_duration=30, language="en", task="transcribe"):
        """
        Initialize the transcriber with the model and processor.

        :param model_name: The name of the Whisper model to use.
        :param chunk_duration: The duration (in seconds) of each chunk for processing.
        :param language: The language of the audio (e.g., 'en' for English, 'fr' for French).
        :param task: The task to perform ('transcribe' or 'translate').
        """
        self.processor = WhisperProcessor.from_pretrained(model_name)
        self.model = WhisperForConditionalGeneration.from_pretrained(model_name)
        self.chunk_duration = chunk_duration
        self.sampling_rate = 16000  # Whisper requires 16 kHz input
        self.language = language
        self.task = task

    def load_audio(self, audio_file_path):
        """
        Load the audio file and resample it to 16 kHz if necessary.

        :param audio_file_path: Path to the audio file.
        :return: A NumPy array of the audio data.
        """
        waveform, sampling_rate = torchaudio.load(audio_file_path)
        if sampling_rate != self.sampling_rate:
            resampler = torchaudio.transforms.Resample(orig_freq=sampling_rate, new_freq=self.sampling_rate)
            waveform = resampler(waveform)
        return waveform.numpy().squeeze()

    def chunk_audio(self, audio_input):
        """
        Split the audio input into smaller chunks.

        :param audio_input: A NumPy array of the audio data.
        :return: A list of audio chunks.
        """
        chunk_length = self.chunk_duration * self.sampling_rate
        return [audio_input[i:i + chunk_length] for i in range(0, len(audio_input), chunk_length)]

    def transcribe(self, audio_file_path):
        """
        Transcribe the given audio file.

        :param audio_file_path: Path to the audio file.
        :return: The full transcription as a string.
        """
        # Load and preprocess the audio
        audio_input = self.load_audio(audio_file_path)

        # Chunk the audio
        chunks = self.chunk_audio(audio_input)

        # Prepare inputs for the model
        inputs = self.processor(
            chunks,
            return_tensors="pt",
            padding="longest",
            return_attention_mask=True,
            sampling_rate=self.sampling_rate
        )

        # Set decoding options for language and task
        generate_kwargs = {
            "forced_decoder_ids": self.processor.get_decoder_prompt_ids(language=self.language, task=self.task)
        }

        # Generate transcription for each chunk
        with torch.no_grad():
            generated_ids = self.model.generate(inputs["input_features"], **generate_kwargs)

        # Decode and combine transcriptions
        transcriptions = self.processor.batch_decode(generated_ids, skip_special_tokens=True)
        final_transcription = " ".join(transcriptions)
        return final_transcription
    
    def trans(self):
        trans="Hey personal, good. Thanks for asking. How are you? I'm good. Yeah, just wait for a couple of minutes. I will join shortly. Sure. I'll. You don't to turn off your video.ut is fine. Turn on your video. It's. Good of uh, did you get a chance to check with Kundal if I not wrong or Pal Kumar'm me a couple of yeah, I just spoke with Kantal the panel. He's driving just in two minutes. He was just stuck in some other meeting. I mean we can do something other stuff which is required before the intdu so just to let's complete that please turn on your camera now. please say your entire screen You want to see my screen? P now I can see it till you in the task manager? Sure. Please call please be on top first. OK yeah now please keep going on scroll down and keep going your, you can close it now and one thing. So I think you are using iPods, right? Right. So if you don't mind, can you please remove that and can you use just a laptop S speaker and laptop mic to communicate? usually don't play for that. background it is going to you, but still you. So sure that in the room where you like projectly sitting, make sure that any other person is not there just for next half an hour minutes or half an hour if you have some electronic ggets like your phone any other ggets just down or make it on you know silent mode so that you will not get disturbed doing. So all those things I think the panel will interview, but just panel is not here still, so I'm just letting you know. So this is all the panel will ask you then you need to share your screen again like you and there will be a questionsated pod this like just sorry for that just some other stuff.. So I guess I spoke with him and so you're to relocate to okay, okay, okay. Open that impossibly., hello, sorry you Kumar and up like you know like I was in a a different call and I was trying to free quickly but you know somehow it was actually so totally fine. So so basically we have done the initial things which required like checking the task manager, screens and and everything we did. I also informed him to not allow anyone in the room and silent all the electronic ggets, raised other instructions. I think there are one more instruction, so you can continue with that has already covered. So that is that from my part so, which is basically, you know, whatever the question I'm going to give you, I'm going to test the same question on the team's check. So you in just copy that question, it on the noteack and read the question increase any doubt asks me then start designing youration, this other questions and answer. Do you think about? Sure. Okay. So Kumar, you know, could you please start me, uh could you please tell me that you know basically just help me toally what the skill you have the way I'm expecting that some that is one is X to his wife that is leg that like that. Could you just tell me your answer? Okay. So I have around six years of experience, so main initon jangle, past APA and I designed testing and uh, you know, I implemented uh standard on not climbs over uh, you know, architectures. and uh based on enterprise applications. So both in Python and I can say in differentines to and uh coming to work, I say we work on an agignmentology. So all my work experience, um has functioned, so, you know, which include maps, which and, you know, likeas. and apart from that I also developed, you know, in the template architectures and designed by applications, right? And um I also implement infrastructure using, you know, uh uh IISC, like terraform, right? And uh terraform audio for AW services like I' used DC to uh S3 RTDS BPC, et cetera. And I've also integrated with the CICD pack plans to like Jenkins get up actions, et cet. and uh, you know, uh for automating this infrastructure, uh using um without avoiding the manual intervention, right? And um, you know, I can also say I have used do in Cubanatus with uh hands on experience and data, uh, you know, uh by dozing these applications, uh all that I underst. Okay. But I couldn't please tell me, um how many years of like experience will happen in our? Overall years of experience? Yes, six years. Okay. And deliber has some experience in by. Yeah, mostly I can say, uh, most of my experiences on and that six. So could you please tell me about the project you have worked on? So what are the challenges in? What are like when I'm saying challenges you fixed, it means that, you know, it is developing why it challenges, it is a designise challengesulatively voice challenges, not any other things. So could you please tell me that you know, what are the contribution you have in the project you have worked on on bikon and and work the challenges you first? Com my project, right at so we used DJoom in the right? So we were working on a project where uh mainly uh I can say it's kind of a regulated envirvironment. So we need to understand an uh in Delhicommunication and customer services, right? uh and how the infrastructure is. So we designed a solution at T-Mobile, uh with uh, you know, uh we designed uh for customer acquisition, uh like, uh, you know, kind of network optimization and uh video design multiple services there. And also we used to predict the uh, you know, uh UX using technical expertise, uh by in the design challenges actually. So whenever uh it's a user centric solution, right? So uh we try to balance between the design and practical implementation, uh within that constraint and uh I can also say, you know, uh this is a bit challenging and also there are some technical immitations with theMobile systems, right, uh, with the data infrastructure or, um, you know, uh with the uh I can say a kind of uh proposing the solutions that are technically uh there and um, you know, which which requires a significant integration um, you know, challenges or refers and uh coming to this design, right? These challenges, uh I can say I have been integrating with T-Mobile with existing design applications, and, yeah, uh to migrate maybe right. and I have a dedicated time to research this telecommunication industry. So uh, you know, I should uh a session with Tobilies, or some trade against some insights or any priorities or needs of the you know, solution. and also, you know, I have created user stories uh to define the needs and goals and uh connected them uh so that, you know, research and implement in demobile with the existing systems and um the data andrastructure. So, uh, yeah, apart from that I can also say, you know, um we have also done, some prototypes uh, here, uh to you do some user interaction and gather the feedback or uh get some familiaty with the you know, uh system or design on the cloud platform, uh, so which which help me, you know, uh get a solution that are with which is compatible with the existing system. So yeah, that was the proof of concert and uh that's how we used to communicate with uh stakeorders. Yes, I understood. But you know, um I could have just tell me that, you know, what are the project you have uh mainly focused on channel project mainly focused on jango I can say you know, uh uh when building these uh you know, basically this project, right? But team about. So uh we have focused mainly on January with the AIs or part of CRM I can say. We're uh we used to build internal tools for uh managing customer data and uh, you know, um and involvedve features like customer segmentation, I said, uh previously and um, you know, and also, you know, have uhian for past facing portals or tasks like um, you know, account management or doing some payments or some doubleooting with the consiststems, right? And uh we also built a few As for online chat and uh, you know, support with the teams.ment? Yeah. Okay, but if this serious industry understood Do you see my screen? are not yet? Yes, no, I can. So as I said, you know, I guess the same question on the king's chat. okay, so my first question to you thatham, so that is basically. It just I'm just copied um uh giving the person change chat with a copy the question, P a note, open one notepack and read the question he tell doubt asks me the stat is design. So there is a class and classes at two attributes on his name and one his age, based on that and creating an object and with the hel of object and transp print some data. Could it please write out Let me copy this.ribute Yeah, this is the So, yeah, uh so I think no, I think you have not um oh okay, so you have given this one that's no, you see that you know, black number seven. That's a two different pain statement. You have made Yes, is yeah. This school didn't. Yeah, uh Honest book, but. Okay, so have given one question that is, can you write a solution to paint the pack and using theamb function? So basically you have to design a single line lamb function that should be capable and bring the pattern I have given. Examples, again. Yeah, uh, I think it's done. So, do you think that it will bring theatter I have given um yes um it would. the reason because you know uh the you it has upper limit and you know it stores the status um where you know it converts the user input and you know, from screen to English. I got it. Okay. So let I have given this function and within the function there are couple of statement and weon over there. So when someone called the function what will be the out, can you decide that one? So, once you call the function, we have to write output for this one, right? So basically, uh put on this case, right, um I can say function one of Yeah, I think and yeah, there's a dark bit of dysfunction would be ten now, so it will be an MLT, uh, you know, so because the list uh, you know, we finally block and always execute and on as well. So Okay, so you just like whatever think Okay, so my biggest question to you that. what I type up in styling jango and can explain the advantage of proxy model? inheritance um can you repeat that question Sorry? I was not about this. Can you can you repeat that question, Kutar? Yeah, you can read the question from chat. What are the ti of what are the type ofred style in, can youies explain the advantage of prox? So coming to this one, right, we have different types I can say, so I can say, you know, uh we can start with abstract class or base classes to define uh con set of feeds and methods that will uh, you know, be shared by multiple concurrent models and where we can, you know, create an abstract class base class abstract class from base class, uh is one thing, list abstract is one thing. Then we have a proxy model, right? uh, where you know, we create a new model., third, um I think of a I mean, otheren proxy model third one is a model model is something which uh, you know, uh we have so that's. Yeah, I have given one another question. So you know there are two models. So one is class article model and one is there is a publication models, okay? Right? Right. So the two model, one is article model and one isation model. Okay, I'm not sure about it is copied fully or not no, no, wait, wait a minute. I think it is there is is. Okay, so second. So there are two modern one is publication model and what is artical model, okay? And can you write the query that I have given in the chat? Sure. I'm not sure about what is happening in that teams he is not copy fully, but the query is this. Okay, so you just the first, there is a class application, there is a class articles and from this class you have to design this square you have. Okay. Okay. I have given the check, the last of last one. copy that too.ifications.. Try your cool.. Here you line. Are you saying something to me like you did you need my assistance? No, I. Oh, good that's. Sorry. I was just trying to read the. Try and exception. if you find an exempt. So example like you say your address ofations, equal to fetch in the schoolations and there school for under school are cool. And what is explain as put. And if if weations more vacation. I try toouse. No publications. found for the kill think ofation so much. Yeah. Yeah, uh, so I've written at uh Kunda. So I' return the fet publications uh function, but you know, I use the headline as a lab parameter and I use uh I topic. So what what let me uh just wait a second, let me check. So do you think that it is a correct chanquir you have written? Because it can be retaining this thing. I'm single line as as in two lands, but um the lines of code we can hear within a six years so experienced within this feet I'll give you the second opportunity to if you want to modify your port. You mean line of 48 and for nine? No, I'm not saying that that is. Do you think that it is a this is the final one you want to summit? let me see yeah I'm telling you a second. Yeah, yeah, this is fine. So there is a relation here, so you know, I think this is fine. I I don't know the change in it. Because he never. So, yeah, I don't want to change anything. I think this is fine. Because it's fine date? Okay.. I think this make it a little bit bigger. The front is because it is a that will be helped. It's Okay. Okay. You put my uh next question. please tell me, you know, you'll have um experience on A development, right? So could you please say what are the operas is supported by the gener basically the jackal uh aeneric list to QAPA but create at least it create least create a list. So basically the right um this will receive list of objects uh of the specific model, uh which is that typically, you know, uh using get um it's uhod's just the method a little bit that support. you want me to write the metals or um I just to tell you that what are the method will be supported get support patch what are the uh basically this will support the method uh and it basically uh post method I can say net takes the post to and um yeah I think uh that's it um I think I have post. Okay. I have given the next question how can I implement the datab which trans in Jango and can you write the example? Okay. So database transactions are, you know, mainly we we do this yeah I know I know in uh can write the example that's I keep explaining things I start too, so that'sactions are lip.., that's fine. Yeah, that's fine. Okay. Okay, so um go on I'm back from my said would you like to ask anything? so so this um um you know, uh this is what Ax right if I'm not the client is, right? Okay. So what what is the project and what of the skills center looking into? So the project is all about uh we need someone who is a very strong pythan knowledge and as well as, you know, with a generalal knowledge. Definitely there will be chances like you know, we are always using like, uh AI of our so definitely if we could create chances to that with an AI definitely that will be in the act advantage. But yeah, definitely we are not looking for someone who is a Kenior will be for someone who is pretty strong in by and channel. So yeah that's nice to hear. Okay, I had to work to go. So you to sell anything part. We can drop up I'm I'm not sure like maybe go with another call. So uh that's fine, yeah, thanks the thing. Sure. Thank you, thanks thanks for your time. Thank you. Hey. He is speaking.uff. Hello. Hey Hello. This can I talk? No. Hello. Can you hear me? just here. Hello., you are operating this guy. He's sc callinging like anything in water. And you here. Hello. Hello. Yak. Adi, voice. Sorry, sorry for that. Andonnect Hello. Basically, support guy is operating, we should not do anything. When coffee pasting anything, he is still in touch. he was operating. He will copy, do everything. holding me like you. You know, I was trying to say, you what are you guys doing? So you something else. That's fine. because you don't know how things work. And you were looking down. did you notice? Oh, I was looking down completely? You were doing, right while writing the c code that is one thing I guess you place your phone, you know? Obviously when you keep look at here here. phone will be like a standing, so you will be able to read directly. You don't have to look here. It will be here on the camera itself, all that, but that will be the little better. I don't is controlling. I thought you were is ans helping you will do this afternoon. I think it went well. What did that it went available? What is the question of things there? Look at this one."
        return trans